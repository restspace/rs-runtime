# Listing

Listing is how Restspace knows the contents of a directory. To make listing work, Restspace makes a distinction between urls ending in a `/` and those which donâ€™t. A request to a url ending in `/` means you are requesting the directory listing.

Restspace directory listings are always JSON and are of mime type `inode/directory+json`.

The default listing is an array of the resource names in the directory. If the resource is a subdirectory, it ends with `/`.

Listing flags can be used to get other kinds of listing.

| Flag | Variation |
| --- | --- |
| details | The full listing details object for the directory is given not just the list of resource names (see below for format) |
| items | For listed item, the item itself (converted to JSON) is given: the JSON returned is an object with the path to the item from the request path as the key. |
| recursive | Listing expands each directory item which is a subdirectory into a list of the items in that subdirectory (the list as defined by the other flags) |
| nodirs | Filter out any directories |
| fileinfo | Keep the full array of file info not just the resource name |
| zip | Get the items recursively in a zip file |

To apply these flags, add the query string e.g.

`?$list=items,recursive`

The full listing details:

```json
interface DirDescriptor {
	path: string; // The path to the current directory
	paths: PathInfo[];
	spec: ApiSpec;
}

type PathInfo = [
	name: string, // resource name
	dateModified?: number, // date modified as JS getTime()
	mimeType?: string, // mime type of the data when reading
	writeMimeType?: string // mime type to write to this resource
] | [
	name: string,
	dateModified?: number,
	spec?: ApiSpec
]

type ApiSpec = StoreSpec | TransformSpec | StoreTransformSpec | ViewSpec | OperationSpec | DirectorySpec;

interface StoreDetails {
    storeMimeTypes: string[]; // the different mime types which can exist in the store
    createDirectory: boolean; // whether a directory can be created
    createFiles: boolean; // whether a file can be created
    exceptionMimeTypes?: Record<string, [ string, string ]>;
}

interface TransformDetails {
    reqMimeType: string; // mime type of the request
    respMimeType: string; // mime type of the response
}

/**
 * A store is a directory which allows resources to be dynamically created and deleted.
 * PUT requests create resources, GET requests read the current value and DELETE requests delete the resource.
 */
export interface StoreSpec extends StoreDetails {
    pattern: "store";
}

/**
 * A transform is a resource which transforms data it receives via a POST request
 */
export interface TransformSpec extends TransformDetails {
    pattern: "transform";
}

/**
 * A store-transform is a directory where each resource defines a transform which
 * can be used to transform data sent to the resource via a POST request.
 */
export interface StoreTransformSpec extends StoreDetails, TransformDetails {
    pattern: "store-transform";
}

/**
 * A view is a resource which returns data to a GET request only
 */
export interface ViewSpec {
    pattern: "view";
    respMimeType: string;
}

/**
 * An operation is a resource to which you POST or PUT data which takes an action but does not return data
 */
export interface OperationSpec {
    pattern: "operation";
    reqMimeType: string;
}

/**
 * A directory is a directory which contains a number of fixed urls which are
 */
export interface DirectorySpec {
    pattern: "directory";
}
	
```